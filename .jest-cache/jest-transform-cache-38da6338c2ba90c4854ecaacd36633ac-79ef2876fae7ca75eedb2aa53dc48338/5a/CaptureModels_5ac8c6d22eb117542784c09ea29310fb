7d992766fc2a574052f4635b1b3dad3a
"use strict";
/**
 * 数据采集核心模型实现
 * 基于原版 C# SharedDriver 模块的精确移植
 * 严格遵循原版的数据结构和逻辑
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.CaptureEventArgs = exports.CaptureRequestBuilder = exports.OutputPacket = exports.CaptureLimitsImpl = exports.BurstInfo = exports.AnalyzerChannel = exports.CaptureSession = void 0;
const AnalyzerTypes_1 = require("./AnalyzerTypes");
/**
 * 采集会话类 - 基于C# CaptureSession的精确实现
 */
class CaptureSession {
    constructor() {
        // 基础采集参数
        this.frequency = 1000000; // 采样频率 (Hz)
        this.preTriggerSamples = 0; // 触发前样本数
        this.postTriggerSamples = 1000; // 触发后样本数
        // 突发采集系统
        this.loopCount = 0; // 突发采集次数 (0-255)
        this.measureBursts = false; // 是否测量突发间隔
        // 通道配置
        this.captureChannels = [];
        // 触发系统配置
        this.triggerType = AnalyzerTypes_1.TriggerType.Edge;
        this.triggerChannel = 0; // 触发通道 (0-23)
        this.triggerInverted = false; // 触发极性反转
        this.triggerBitCount = 1; // 触发位宽
        this.triggerPattern = 0; // 复杂触发模式 (16位)
    }
    /**
     * 总样本数计算 - 对应C#的只读属性
     */
    get totalSamples() {
        return this.postTriggerSamples * (this.loopCount + 1) + this.preTriggerSamples;
    }
    /**
     * 深拷贝包含样本数据 - 对应C#的Clone()方法
     */
    clone() {
        const newInst = new CaptureSession();
        // 复制基础属性
        newInst.frequency = this.frequency;
        newInst.preTriggerSamples = this.preTriggerSamples;
        newInst.postTriggerSamples = this.postTriggerSamples;
        newInst.loopCount = this.loopCount;
        newInst.measureBursts = this.measureBursts;
        newInst.triggerType = this.triggerType;
        newInst.triggerChannel = this.triggerChannel;
        newInst.triggerInverted = this.triggerInverted;
        newInst.triggerBitCount = this.triggerBitCount;
        newInst.triggerPattern = this.triggerPattern;
        // 深拷贝通道数组
        newInst.captureChannels = this.captureChannels.map(ch => ch.clone());
        // 深拷贝突发信息
        if (this.bursts) {
            newInst.bursts = this.bursts.map(burst => {
                const newBurst = new BurstInfo();
                newBurst.burstSampleStart = burst.burstSampleStart;
                newBurst.burstSampleEnd = burst.burstSampleEnd;
                newBurst.burstSampleGap = burst.burstSampleGap;
                newBurst.burstTimeGap = burst.burstTimeGap;
                return newBurst;
            });
        }
        return newInst;
    }
    /**
     * 只拷贝设置，不含样本数据 - 对应C#的CloneSettings()方法
     */
    cloneSettings() {
        const newInst = new CaptureSession();
        // 复制基础属性
        newInst.frequency = this.frequency;
        newInst.preTriggerSamples = this.preTriggerSamples;
        newInst.postTriggerSamples = this.postTriggerSamples;
        newInst.loopCount = this.loopCount;
        newInst.measureBursts = this.measureBursts;
        newInst.triggerType = this.triggerType;
        newInst.triggerChannel = this.triggerChannel;
        newInst.triggerInverted = this.triggerInverted;
        newInst.triggerBitCount = this.triggerBitCount;
        newInst.triggerPattern = this.triggerPattern;
        // 复制通道设置，但清空样本数据
        newInst.captureChannels = this.captureChannels.map(ch => {
            const clonedChannel = ch.clone();
            clonedChannel.samples = undefined; // 清空样本数据
            return clonedChannel;
        });
        return newInst;
    }
}
exports.CaptureSession = CaptureSession;
/**
 * 分析器通道类 - 基于C# AnalyzerChannel的精确实现
 */
class AnalyzerChannel {
    constructor(channelNumber = 0, channelName = '') {
        this.channelNumber = 0;
        this.channelName = '';
        this.hidden = false;
        this.minimized = false; // 最小化显示状态
        this.channelNumber = channelNumber;
        this.channelName = channelName || this.textualChannelNumber;
    }
    /**
     * 文本化通道号 - 对应C#的TextualChannelNumber getter
     */
    get textualChannelNumber() {
        return `Channel ${this.channelNumber + 1}`;
    }
    /**
     * ToString方法 - 对应C#的ToString()重写
     */
    toString() {
        return this.channelName || this.textualChannelNumber;
    }
    /**
     * 克隆方法 - 对应C#的Clone()方法，包含深拷贝支持
     */
    clone() {
        const newInst = new AnalyzerChannel();
        newInst.channelNumber = this.channelNumber;
        newInst.channelName = this.channelName;
        newInst.channelColor = this.channelColor;
        newInst.hidden = this.hidden;
        // 深拷贝样本数据
        if (this.samples) {
            newInst.samples = new Uint8Array(this.samples);
        }
        return newInst;
    }
}
exports.AnalyzerChannel = AnalyzerChannel;
/**
 * 突发信息类 - 基于C# BurstInfo的精确实现
 */
class BurstInfo {
    constructor() {
        this.burstSampleStart = 0; // 突发开始样本位置
        this.burstSampleEnd = 0; // 突发结束样本位置
        this.burstSampleGap = 0; // 样本间隔数量 (ulong)
        this.burstTimeGap = 0; // 时间间隔 (纳秒, ulong)
    }
    /**
     * 时间格式化方法 - 对应C#的GetTime()方法
     */
    getTime() {
        const nanoInMicro = 1000.0;
        const nanoInMilli = 1000000.0;
        const nanoInSecond = 1000000000.0;
        if (this.burstTimeGap < nanoInMicro) {
            return `${this.burstTimeGap} ns`;
        }
        else if (this.burstTimeGap < nanoInMilli) {
            const microseconds = this.burstTimeGap / nanoInMicro;
            return `${microseconds.toFixed(3)} µs`;
        }
        else if (this.burstTimeGap < nanoInSecond) {
            const milliseconds = this.burstTimeGap / nanoInMilli;
            return `${milliseconds.toFixed(3)} ms`;
        }
        else {
            const seconds = this.burstTimeGap / nanoInSecond;
            return `${seconds.toFixed(3)} s`;
        }
    }
    /**
     * ToString方法 - 对应C#的ToString()重写
     */
    toString() {
        return `Burst: ${this.burstSampleStart} to ${this.burstSampleEnd}\nGap: ${this.getTime()} (${this.burstSampleGap} samples)`;
    }
}
exports.BurstInfo = BurstInfo;
/**
 * 采集限制类 - 基于C# CaptureLimits的实现，添加了计算属性
 */
class CaptureLimitsImpl {
    constructor() {
        this.minPreSamples = 2;
        this.maxPreSamples = 1000;
        this.minPostSamples = 2;
        this.maxPostSamples = 10000;
    }
    /**
     * 最大总样本数 - 对应C#的MaxTotalSamples getter
     * 应该是maxPreSamples + maxPostSamples
     */
    get maxTotalSamples() {
        return this.maxPreSamples + this.maxPostSamples;
    }
}
exports.CaptureLimitsImpl = CaptureLimitsImpl;
/**
 * 输出数据包类 - 基于C# OutputPacket的精确实现
 * 🚀 关键的通信协议实现，包含转义机制
 */
class OutputPacket {
    constructor() {
        this.dataBuffer = [];
    }
    /**
     * 添加单个字节
     */
    addByte(newByte) {
        this.dataBuffer.push(newByte & 0xFF);
    }
    /**
     * 添加字节数组
     */
    addBytes(newBytes) {
        if (newBytes instanceof Uint8Array) {
            for (let i = 0; i < newBytes.length; i++) {
                this.dataBuffer.push(newBytes[i]);
            }
        }
        else {
            this.dataBuffer.push(...newBytes.map(b => b & 0xFF));
        }
    }
    /**
     * 添加ASCII字符串
     */
    addString(newString) {
        const encoder = new TextEncoder();
        const bytes = encoder.encode(newString);
        this.addBytes(bytes);
    }
    /**
     * 添加结构体 - TypeScript版本使用ArrayBuffer
     */
    addStruct(structData) {
        if (structData instanceof ArrayBuffer) {
            this.addBytes(new Uint8Array(structData));
        }
        else {
            this.addBytes(structData);
        }
    }
    /**
     * 清空缓冲区
     */
    clear() {
        this.dataBuffer = [];
    }
    /**
     * 序列化数据包 - 对应C#的关键协议实现
     * 协议格式: 0x55 0xAA [转义后的数据] 0xAA 0x55
     * 转义规则: 0xAA/0x55/0xF0 -> 0xF0 + (原值 ^ 0xF0)
     */
    serialize() {
        const finalData = [];
        // 添加起始标记
        finalData.push(0x55);
        finalData.push(0xAA);
        // 对数据进行转义处理
        for (const byte of this.dataBuffer) {
            if (byte === 0xAA || byte === 0x55 || byte === 0xF0) {
                finalData.push(0xF0);
                finalData.push(byte ^ 0xF0);
            }
            else {
                finalData.push(byte);
            }
        }
        // 添加结束标记
        finalData.push(0xAA);
        finalData.push(0x55);
        return new Uint8Array(finalData);
    }
}
exports.OutputPacket = OutputPacket;
/**
 * 采集请求构建器 - 用于构建符合C#结构体布局的二进制数据
 */
class CaptureRequestBuilder {
    /**
     * 构建采集请求的二进制数据
     */
    static buildCaptureRequest(session) {
        const buffer = new ArrayBuffer(64); // 预分配足够的空间
        const view = new DataView(buffer);
        let offset = 0;
        // 按照C#结构体的精确布局写入数据
        view.setUint8(offset++, session.triggerType); // triggerType: byte
        view.setUint8(offset++, session.triggerChannel); // trigger: byte
        view.setUint8(offset++, session.triggerInverted ? 1 : 0); // invertedOrCount: byte
        view.setUint16(offset, session.triggerPattern, true); // triggerValue: ushort, little endian
        offset += 2;
        // channels: byte[24] - 通道配置数组
        const channelArray = new Uint8Array(24);
        session.captureChannels.forEach(ch => {
            if (ch.channelNumber >= 0 && ch.channelNumber < 24) {
                channelArray[ch.channelNumber] = 1;
            }
        });
        for (let i = 0; i < 24; i++) {
            view.setUint8(offset++, channelArray[i]);
        }
        view.setUint8(offset++, session.captureChannels.length); // channelCount: byte
        view.setUint32(offset, session.frequency, true); // frequency: uint32, little endian
        offset += 4;
        view.setUint32(offset, session.preTriggerSamples, true); // preSamples: uint32, little endian
        offset += 4;
        view.setUint32(offset, session.postTriggerSamples, true); // postSamples: uint32, little endian
        offset += 4;
        view.setUint8(offset++, session.loopCount); // loopCount: byte
        view.setUint8(offset++, session.measureBursts ? 1 : 0); // measure: byte
        // 计算采集模式
        const maxChannel = Math.max(...session.captureChannels.map(ch => ch.channelNumber));
        const captureMode = maxChannel < 8 ? AnalyzerTypes_1.CaptureMode.Channels_8 :
            (maxChannel < 16 ? AnalyzerTypes_1.CaptureMode.Channels_16 : AnalyzerTypes_1.CaptureMode.Channels_24);
        view.setUint8(offset++, captureMode); // captureMode: byte
        return new Uint8Array(buffer, 0, offset);
    }
    /**
     * 构建网络配置的二进制数据
     */
    static buildNetConfig(config) {
        const buffer = new ArrayBuffer(115); // 33 + 64 + 16 + 2 = 115字节
        const view = new DataView(buffer);
        let offset = 0;
        // AccessPointName: 33字节固定长度
        const apNameBytes = new TextEncoder().encode(config.accessPointName.slice(0, 32));
        for (let i = 0; i < 33; i++) {
            view.setUint8(offset++, i < apNameBytes.length ? apNameBytes[i] : 0);
        }
        // Password: 64字节固定长度
        const passwordBytes = new TextEncoder().encode(config.password.slice(0, 63));
        for (let i = 0; i < 64; i++) {
            view.setUint8(offset++, i < passwordBytes.length ? passwordBytes[i] : 0);
        }
        // IPAddress: 16字节固定长度
        const ipBytes = new TextEncoder().encode(config.ipAddress.slice(0, 15));
        for (let i = 0; i < 16; i++) {
            view.setUint8(offset++, i < ipBytes.length ? ipBytes[i] : 0);
        }
        // Port: ushort (16位)
        view.setUint16(offset, config.port, true); // little endian
        return new Uint8Array(buffer);
    }
}
exports.CaptureRequestBuilder = CaptureRequestBuilder;
/**
 * 数据采集事件参数
 */
class CaptureEventArgs {
    constructor(success, session) {
        this.success = false;
        this.success = success;
        this.session = session;
    }
}
exports.CaptureEventArgs = CaptureEventArgs;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvc2hhcmUvc2FtYmEvdnNjb2RlLWV4dGVuc2lvbi9waWNvLWxvZ2ljYW5hbHl6ZXIvc3JjL21vZGVscy9DYXB0dXJlTW9kZWxzLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7OztHQUlHOzs7QUFFSCxtREFPeUI7QUFFekI7O0dBRUc7QUFDSCxNQUFhLGNBQWM7SUFBM0I7UUFDRSxTQUFTO1FBQ0YsY0FBUyxHQUFXLE9BQU8sQ0FBQyxDQUFDLFlBQVk7UUFDekMsc0JBQWlCLEdBQVcsQ0FBQyxDQUFDLENBQUMsU0FBUztRQUN4Qyx1QkFBa0IsR0FBVyxJQUFJLENBQUMsQ0FBQyxTQUFTO1FBRW5ELFNBQVM7UUFDRixjQUFTLEdBQVcsQ0FBQyxDQUFDLENBQUMsaUJBQWlCO1FBQ3hDLGtCQUFhLEdBQVksS0FBSyxDQUFDLENBQUMsV0FBVztRQUVsRCxPQUFPO1FBQ0Esb0JBQWUsR0FBc0IsRUFBRSxDQUFDO1FBSy9DLFNBQVM7UUFDRixnQkFBVyxHQUFnQiwyQkFBVyxDQUFDLElBQUksQ0FBQztRQUM1QyxtQkFBYyxHQUFXLENBQUMsQ0FBQyxDQUFDLGNBQWM7UUFDMUMsb0JBQWUsR0FBWSxLQUFLLENBQUMsQ0FBQyxTQUFTO1FBQzNDLG9CQUFlLEdBQVcsQ0FBQyxDQUFDLENBQUMsT0FBTztRQUNwQyxtQkFBYyxHQUFXLENBQUMsQ0FBQyxDQUFDLGVBQWU7SUF3RXBELENBQUM7SUF0RUM7O09BRUc7SUFDSCxJQUFXLFlBQVk7UUFDckIsT0FBTyxJQUFJLENBQUMsa0JBQWtCLEdBQUcsQ0FBQyxJQUFJLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQztJQUNqRixDQUFDO0lBRUQ7O09BRUc7SUFDSSxLQUFLO1FBQ1YsTUFBTSxPQUFPLEdBQUcsSUFBSSxjQUFjLEVBQUUsQ0FBQztRQUVyQyxTQUFTO1FBQ1QsT0FBTyxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDO1FBQ25DLE9BQU8sQ0FBQyxpQkFBaUIsR0FBRyxJQUFJ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Q0FDRjtBQVJELDRDQVFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3NoYXJlL3NhbWJhL3ZzY29kZS1leHRlbnNpb24vcGljby1sb2dpY2FuYWx5emVyL3NyYy9tb2RlbHMvQ2FwdHVyZU1vZGVscy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICog5pWw5o2u6YeH6ZuG5qC45b+D5qih5Z6L5a6e546wXHJcbiAqIOWfuuS6juWOn+eJiCBDIyBTaGFyZWREcml2ZXIg5qih5Z2X55qE57K+56Gu56e75qSNXHJcbiAqIOS4peagvOmBteW+quWOn+eJiOeahOaVsOaNrue7k+aehOWSjOmAu+i+kVxyXG4gKi9cclxuXHJcbmltcG9ydCB7XHJcbiAgVHJpZ2dlclR5cGUsXHJcbiAgQ2FwdHVyZU1vZGUsXHJcbiAgQ2FwdHVyZUVycm9yLFxyXG4gIENhcHR1cmVMaW1pdHMsXHJcbiAgQW5hbHl6ZXJEZXZpY2VJbmZvLFxyXG4gIFRyaWdnZXJEZWxheXNcclxufSBmcm9tICcuL0FuYWx5emVyVHlwZXMnO1xyXG5cclxuLyoqXHJcbiAqIOmHh+mbhuS8muivneexuyAtIOWfuuS6jkMjIENhcHR1cmVTZXNzaW9u55qE57K+56Gu5a6e546wXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQ2FwdHVyZVNlc3Npb24ge1xyXG4gIC8vIOWfuuehgOmHh+mbhuWPguaVsFxyXG4gIHB1YmxpYyBmcmVxdWVuY3k6IG51bWJlciA9IDEwMDAwMDA7IC8vIOmHh+agt+mikeeOhyAoSHopXHJcbiAgcHVibGljIHByZVRyaWdnZXJTYW1wbGVzOiBudW1iZXIgPSAwOyAvLyDop6blj5HliY3moLfmnKzmlbBcclxuICBwdWJsaWMgcG9zdFRyaWdnZXJTYW1wbGVzOiBudW1iZXIgPSAxMDAwOyAvLyDop6blj5HlkI7moLfmnKzmlbBcclxuXHJcbiAgLy8g56qB5Y+R6YeH6ZuG57O757ufXHJcbiAgcHVibGljIGxvb3BDb3VudDogbnVtYmVyID0gMDsgLy8g56qB5Y+R6YeH6ZuG5qyh5pWwICgwLTI1NSlcclxuICBwdWJsaWMgbWVhc3VyZUJ1cnN0czogYm9vbGVhbiA9IGZhbHNlOyAvLyDmmK/lkKbmtYvph4/nqoHlj5Hpl7TpmpRcclxuXHJcbiAgLy8g6YCa6YGT6YWN572uXHJcbiAgcHVibGljIGNhcHR1cmVDaGFubmVsczogQW5hbHl6ZXJDaGFubmVsW10gPSBbXTtcclxuXHJcbiAgLy8g56qB5Y+R5L+h5oGv5pWw57uEICjph4fpm4blrozmiJDlkI7loavlhYUpXHJcbiAgcHVibGljIGJ1cnN0cz86IEJ1cnN0SW5mb1tdO1xyXG5cclxuICAvLyDop6blj5Hns7vnu5/phY3nva5cclxuICBwdWJsaWMgdHJpZ2dlclR5cGU6IFRyaWdnZXJUeXBlID0gVHJpZ2dlclR5cGUuRWRnZTtcclxuICBwdWJsaWMgdHJpZ2dlckNoYW5uZWw6IG51bWJlciA9IDA7IC8vIOinpuWPkemAmumBkyAoMC0yMylcclxuICBwdWJsaWMgdHJpZ2dlckludmVydGVkOiBib29sZWFuID0gZmFsc2U7IC8vIOinpuWPkeaegeaAp+WPjei9rFxyXG4gIHB1YmxpYyB0cmlnZ2VyQml0Q291bnQ6IG51bWJlciA9IDE7IC8vIOinpuWPkeS9jeWuvVxyXG4gIHB1YmxpYyB0cmlnZ2VyUGF0dGVybjogbnVtYmVyID0gMDsgLy8g5aSN5p2C6Kem5Y+R5qih5byPICgxNuS9jSlcclxuXHJcbiAgLyoqXHJcbiAgICog5oC75qC35pys5pWw6K6h566XIC0g5a+55bqUQyPnmoTlj6ror7vlsZ7mgKdcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0IHRvdGFsU2FtcGxlcygpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMucG9zdFRyaWdnZXJTYW1wbGVzICogKHRoaXMubG9vcENvdW50ICsgMSkgKyB0aGlzLnByZVRyaWdnZXJTYW1wbGVzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5rex5ou36LSd5YyF5ZCr5qC35pys5pWw5o2uIC0g5a+55bqUQyPnmoRDbG9uZSgp5pa55rOVXHJcbiAgICovXHJcbiAgcHVibGljIGNsb25lKCk6IENhcHR1cmVTZXNzaW9uIHtcclxuICAgIGNvbnN0IG5ld0luc3QgPSBuZXcgQ2FwdHVyZVNlc3Npb24oKTtcclxuXHJcbiAgICAvLyDlpI3liLbln7rnoYDlsZ7mgKdcclxuICAgIG5ld0luc3QuZnJlcXVlbmN5ID0gdGhpcy5mcmVxdWVuY3k7XHJcbiAgICBuZXdJbnN0LnByZVRyaWdnZXJTYW1wbGVzID0gdGhpcy5wcmVUcmlnZ2VyU2FtcGxlcztcclxuICAgIG5ld0luc3QucG9zdFRyaWdnZXJTYW1wbGVzID0gdGhpcy5wb3N0VHJpZ2dlclNhbXBsZXM7XHJcbiAgICBuZXdJbnN0Lmxvb3BDb3VudCA9IHRoaXMubG9vcENvdW50O1xyXG4gICAgbmV3SW5zdC5tZWFzdXJlQnVyc3RzID0gdGhpcy5tZWFzdXJlQnVyc3RzO1xyXG4gICAgbmV3SW5zdC50cmlnZ2VyVHlwZSA9IHRoaXMudHJpZ2dlclR5cGU7XHJcbiAgICBuZXdJbnN0LnRyaWdnZXJDaGFubmVsID0gdGhpcy50cmlnZ2VyQ2hhbm5lbDtcclxuICAgIG5ld0luc3QudHJpZ2dlckludmVydGVkID0gdGhpcy50cmlnZ2VySW52ZXJ0ZWQ7XHJcbiAgICBuZXdJbnN0LnRyaWdnZXJCaXRDb3VudCA9IHRoaXMudHJpZ2dlckJpdENvdW50O1xyXG4gICAgbmV3SW5zdC50cmlnZ2VyUGF0dGVybiA9IHRoaXMudHJpZ2dlclBhdHRlcm47XHJcblxyXG4gICAgLy8g5rex5ou36LSd6YCa6YGT5pWw57uEXHJcbiAgICBuZXdJbnN0LmNhcHR1cmVDaGFubmVscyA9IHRoaXMuY2FwdHVyZUNoYW5uZWxzLm1hcChjaCA9PiBjaC5jbG9uZSgpKTtcclxuXHJcbiAgICAvLyDmt7Hmi7fotJ3nqoHlj5Hkv6Hmga9cclxuICAgIGlmICh0aGlzLmJ1cnN0cykge1xyXG4gICAgICBuZXdJbnN0LmJ1cnN0cyA9IHRoaXMuYnVyc3RzLm1hcChidXJzdCA9PiB7XHJcbiAgICAgICAgY29uc3QgbmV3QnVyc3QgPSBuZXcgQnVyc3RJbmZvKCk7XHJcbiAgICAgICAgbmV3QnVyc3QuYnVyc3RTYW1wbGVTdGFydCA9IGJ1cnN0LmJ1cnN0U2FtcGxlU3RhcnQ7XHJcbiAgICAgICAgbmV3QnVyc3QuYnVyc3RTYW1wbGVFbmQgPSBidXJzdC5idXJzdFNhbXBsZUVuZDtcclxuICAgICAgICBuZXdCdXJzdC5idXJzdFNhbXBsZUdhcCA9IGJ1cnN0LmJ1cnN0U2FtcGxlR2FwO1xyXG4gICAgICAgIG5ld0J1cnN0LmJ1cnN0VGltZUdhcCA9IGJ1cnN0LmJ1cnN0VGltZUdhcDtcclxuICAgICAgICByZXR1cm4gbmV3QnVyc3Q7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBuZXdJbnN0O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5Y+q5ou36LSd6K6+572u77yM5LiN5ZCr5qC35pys5pWw5o2uIC0g5a+55bqUQyPnmoRDbG9uZVNldHRpbmdzKCnmlrnms5VcclxuICAgKi9cclxuICBwdWJsaWMgY2xvbmVTZXR0aW5ncygpOiBDYXB0dXJlU2Vzc2lvbiB7XHJcbiAgICBjb25zdCBuZXdJbnN0ID0gbmV3IENhcHR1cmVTZXNzaW9uKCk7XHJcblxyXG4gICAgLy8g5aSN5Yi25Z+656GA5bGe5oCnXHJcbiAgICBuZXdJbnN0LmZyZXF1ZW5jeSA9IHRoaXMuZnJlcXVlbmN5O1xyXG4gICAgbmV3SW5zdC5wcmVUcmlnZ2VyU2FtcGxlcyA9IHRoaXMucHJlVHJpZ2dlclNhbXBsZXM7XHJcbiAgICBuZXdJbnN0LnBvc3RUcmlnZ2VyU2FtcGxlcyA9IHRoaXMucG9zdFRyaWdnZXJTYW1wbGVzO1xyXG4gICAgbmV3SW5zdC5sb29wQ291bnQgPSB0aGlzLmxvb3BDb3VudDtcclxuICAgIG5ld0luc3QubWVhc3VyZUJ1cnN0cyA9IHRoaXMubWVhc3VyZUJ1cnN0cztcclxuICAgIG5ld0luc3QudHJpZ2dlclR5cGUgPSB0aGlzLnRyaWdnZXJUeXBlO1xyXG4gICAgbmV3SW5zdC50cmlnZ2VyQ2hhbm5lbCA9IHRoaXMudHJpZ2dlckNoYW5uZWw7XHJcbiAgICBuZXdJbnN0LnRyaWdnZXJJbnZlcnRlZCA9IHRoaXMudHJpZ2dlckludmVydGVkO1xyXG4gICAgbmV3SW5zdC50cmlnZ2VyQml0Q291bnQgPSB0aGlzLnRyaWdnZXJCaXRDb3VudDtcclxuICAgIG5ld0luc3QudHJpZ2dlclBhdHRlcm4gPSB0aGlzLnRyaWdnZXJQYXR0ZXJuO1xyXG5cclxuICAgIC8vIOWkjeWItumAmumBk+iuvue9ru+8jOS9hua4heepuuagt+acrOaVsOaNrlxyXG4gICAgbmV3SW5zdC5jYXB0dXJlQ2hhbm5lbHMgPSB0aGlzLmNhcHR1cmVDaGFubmVscy5tYXAoY2ggPT4ge1xyXG4gICAgICBjb25zdCBjbG9uZWRDaGFubmVsID0gY2guY2xvbmUoKTtcclxuICAgICAgY2xvbmVkQ2hhbm5lbC5zYW1wbGVzID0gdW5kZWZpbmVkOyAvLyDmuIXnqbrmoLfmnKzmlbDmja5cclxuICAgICAgcmV0dXJuIGNsb25lZENoYW5uZWw7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gbmV3SW5zdDtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDliIbmnpDlmajpgJrpgZPnsbsgLSDln7rkuo5DIyBBbmFseXplckNoYW5uZWznmoTnsr7noa7lrp7njrBcclxuICovXHJcbmV4cG9ydCBjbGFzcyBBbmFseXplckNoYW5uZWwge1xyXG4gIHB1YmxpYyBjaGFubmVsTnVtYmVyOiBudW1iZXIgPSAwO1xyXG4gIHB1YmxpYyBjaGFubmVsTmFtZTogc3RyaW5nID0gJyc7XHJcbiAgcHVibGljIGNoYW5uZWxDb2xvcj86IG51bWJlcjsgLy8gdWludD8g5a+55bqUVHlwZVNjcmlwdOeahG51bWJlciB8IHVuZGVmaW5lZFxyXG4gIHB1YmxpYyBoaWRkZW46IGJvb2xlYW4gPSBmYWxzZTtcclxuICBwdWJsaWMgbWluaW1pemVkPzogYm9vbGVhbiA9IGZhbHNlOyAvLyDmnIDlsI/ljJbmmL7npLrnirbmgIFcclxuICBwdWJsaWMgc2FtcGxlcz86IFVpbnQ4QXJyYXk7IC8vIGJ5dGVbXSDlr7nlupRUeXBlU2NyaXB055qEVWludDhBcnJheVxyXG5cclxuICBjb25zdHJ1Y3RvcihjaGFubmVsTnVtYmVyOiBudW1iZXIgPSAwLCBjaGFubmVsTmFtZTogc3RyaW5nID0gJycpIHtcclxuICAgIHRoaXMuY2hhbm5lbE51bWJlciA9IGNoYW5uZWxOdW1iZXI7XHJcbiAgICB0aGlzLmNoYW5uZWxOYW1lID0gY2hhbm5lbE5hbWUgfHwgdGhpcy50ZXh0dWFsQ2hhbm5lbE51bWJlcjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOaWh+acrOWMlumAmumBk+WPtyAtIOWvueW6lEMj55qEVGV4dHVhbENoYW5uZWxOdW1iZXIgZ2V0dGVyXHJcbiAgICovXHJcbiAgcHVibGljIGdldCB0ZXh0dWFsQ2hhbm5lbE51bWJlcigpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIGBDaGFubmVsICR7dGhpcy5jaGFubmVsTnVtYmVyICsgMX1gO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVG9TdHJpbmfmlrnms5UgLSDlr7nlupRDI+eahFRvU3RyaW5nKCnph43lhplcclxuICAgKi9cclxuICBwdWJsaWMgdG9TdHJpbmcoKTogc3RyaW5nIHtcclxuICAgIHJldHVybiB0aGlzLmNoYW5uZWxOYW1lIHx8IHRoaXMudGV4dHVhbENoYW5uZWxOdW1iZXI7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlhYvpmobmlrnms5UgLSDlr7nlupRDI+eahENsb25lKCnmlrnms5XvvIzljIXlkKvmt7Hmi7fotJ3mlK/mjIFcclxuICAgKi9cclxuICBwdWJsaWMgY2xvbmUoKTogQW5hbHl6ZXJDaGFubmVsIHtcclxuICAgIGNvbnN0IG5ld0luc3QgPSBuZXcgQW5hbHl6ZXJDaGFubmVsKCk7XHJcbiAgICBuZXdJbnN0LmNoYW5uZWxOdW1iZXIgPSB0aGlzLmNoYW5uZWxOdW1iZXI7XHJcbiAgICBuZXdJbnN0LmNoYW5uZWxOYW1lID0gdGhpcy5jaGFubmVsTmFtZTtcclxuICAgIG5ld0luc3QuY2hhbm5lbENvbG9yID0gdGhpcy5jaGFubmVsQ29sb3I7XHJcbiAgICBuZXdJbnN0LmhpZGRlbiA9IHRoaXMuaGlkZGVuO1xyXG5cclxuICAgIC8vIOa3seaLt+i0neagt+acrOaVsOaNrlxyXG4gICAgaWYgKHRoaXMuc2FtcGxlcykge1xyXG4gICAgICBuZXdJbnN0LnNhbXBsZXMgPSBuZXcgVWludDhBcnJheSh0aGlzLnNhbXBsZXMpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBuZXdJbnN0O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOeqgeWPkeS/oeaBr+exuyAtIOWfuuS6jkMjIEJ1cnN0SW5mb+eahOeyvuehruWunueOsFxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEJ1cnN0SW5mbyB7XHJcbiAgcHVibGljIGJ1cnN0U2FtcGxlU3RhcnQ6IG51bWJlciA9IDA7IC8vIOeqgeWPkeW8gOWni+agt+acrOS9jee9rlxyXG4gIHB1YmxpYyBidXJzdFNhbXBsZUVuZDogbnVtYmVyID0gMDsgLy8g56qB5Y+R57uT5p2f5qC35pys5L2N572uXHJcbiAgcHVibGljIGJ1cnN0U2FtcGxlR2FwOiBudW1iZXIgPSAwOyAvLyDmoLfmnKzpl7TpmpTmlbDph48gKHVsb25nKVxyXG4gIHB1YmxpYyBidXJzdFRpbWVHYXA6IG51bWJlciA9IDA7IC8vIOaXtumXtOmXtOmalCAo57qz56eSLCB1bG9uZylcclxuXHJcbiAgLyoqXHJcbiAgICog5pe26Ze05qC85byP5YyW5pa55rOVIC0g5a+55bqUQyPnmoRHZXRUaW1lKCnmlrnms5VcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0VGltZSgpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgbmFub0luTWljcm8gPSAxMDAwLjA7XHJcbiAgICBjb25zdCBuYW5vSW5NaWxsaSA9IDEwMDAwMDAuMDtcclxuICAgIGNvbnN0IG5hbm9JblNlY29uZCA9IDEwMDAwMDAwMDAuMDtcclxuXHJcbiAgICBpZiAodGhpcy5idXJzdFRpbWVHYXAgPCBuYW5vSW5NaWNybykge1xyXG4gICAgICByZXR1cm4gYCR7dGhpcy5idXJzdFRpbWVHYXB9IG5zYDtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5idXJzdFRpbWVHYXAgPCBuYW5vSW5NaWxsaSkge1xyXG4gICAgICBjb25zdCBtaWNyb3NlY29uZHMgPSB0aGlzLmJ1cnN0VGltZUdhcCAvIG5hbm9Jbk1pY3JvO1xyXG4gICAgICByZXR1cm4gYCR7bWljcm9zZWNvbmRzLnRvRml4ZWQoMyl9IMK1c2A7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMuYnVyc3RUaW1lR2FwIDwgbmFub0luU2Vjb25kKSB7XHJcbiAgICAgIGNvbnN0IG1pbGxpc2Vjb25kcyA9IHRoaXMuYnVyc3RUaW1lR2FwIC8gbmFub0luTWlsbGk7XHJcbiAgICAgIHJldHVybiBgJHttaWxsaXNlY29uZHMudG9GaXhlZCgzKX0gbXNgO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc3Qgc2Vjb25kcyA9IHRoaXMuYnVyc3RUaW1lR2FwIC8gbmFub0luU2Vjb25kO1xyXG4gICAgICByZXR1cm4gYCR7c2Vjb25kcy50b0ZpeGVkKDMpfSBzYDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRvU3RyaW5n5pa55rOVIC0g5a+55bqUQyPnmoRUb1N0cmluZygp6YeN5YaZXHJcbiAgICovXHJcbiAgcHVibGljIHRvU3RyaW5nKCk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gYEJ1cnN0OiAke3RoaXMuYnVyc3RTYW1wbGVTdGFydH0gdG8gJHt0aGlzLmJ1cnN0U2FtcGxlRW5kfVxcbkdhcDogJHt0aGlzLmdldFRpbWUoKX0gKCR7dGhpcy5idXJzdFNhbXBsZUdhcH0gc2FtcGxlcylgO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOmHh+mbhumZkOWItuexuyAtIOWfuuS6jkMjIENhcHR1cmVMaW1pdHPnmoTlrp7njrDvvIzmt7vliqDkuoborqHnrpflsZ7mgKdcclxuICovXHJcbmV4cG9ydCBjbGFzcyBDYXB0dXJlTGltaXRzSW1wbCBpbXBsZW1lbnRzIENhcHR1cmVMaW1pdHMge1xyXG4gIHB1YmxpYyBtaW5QcmVTYW1wbGVzOiBudW1iZXIgPSAyO1xyXG4gIHB1YmxpYyBtYXhQcmVTYW1wbGVzOiBudW1iZXIgPSAxMDAwO1xyXG4gIHB1YmxpYyBtaW5Qb3N0U2FtcGxlczogbnVtYmVyID0gMjtcclxuICBwdWJsaWMgbWF4UG9zdFNhbXBsZXM6IG51bWJlciA9IDEwMDAwO1xyXG5cclxuICAvKipcclxuICAgKiDmnIDlpKfmgLvmoLfmnKzmlbAgLSDlr7nlupRDI+eahE1heFRvdGFsU2FtcGxlcyBnZXR0ZXJcclxuICAgKiDlupTor6XmmK9tYXhQcmVTYW1wbGVzICsgbWF4UG9zdFNhbXBsZXNcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0IG1heFRvdGFsU2FtcGxlcygpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMubWF4UHJlU2FtcGxlcyArIHRoaXMubWF4UG9zdFNhbXBsZXM7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICog6L6T5Ye65pWw5o2u5YyF57G7IC0g5Z+65LqOQyMgT3V0cHV0UGFja2V055qE57K+56Gu5a6e546wXHJcbiAqIPCfmoAg5YWz6ZSu55qE6YCa5L+h5Y2P6K6u5a6e546w77yM5YyF5ZCr6L2s5LmJ5py65Yi2XHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgT3V0cHV0UGFja2V0IHtcclxuICBwcml2YXRlIGRhdGFCdWZmZXI6IG51bWJlcltdID0gW107XHJcblxyXG4gIC8qKlxyXG4gICAqIOa3u+WKoOWNleS4quWtl+iKglxyXG4gICAqL1xyXG4gIHB1YmxpYyBhZGRCeXRlKG5ld0J5dGU6IG51bWJlcik6IHZvaWQge1xyXG4gICAgdGhpcy5kYXRhQnVmZmVyLnB1c2gobmV3Qnl0ZSAmIDB4RkYpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5re75Yqg5a2X6IqC5pWw57uEXHJcbiAgICovXHJcbiAgcHVibGljIGFkZEJ5dGVzKG5ld0J5dGVzOiBVaW50OEFycmF5IHwgbnVtYmVyW10pOiB2b2lkIHtcclxuICAgIGlmIChuZXdCeXRlcyBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHtcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuZXdCeXRlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHRoaXMuZGF0YUJ1ZmZlci5wdXNoKG5ld0J5dGVzW2ldKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5kYXRhQnVmZmVyLnB1c2goLi4ubmV3Qnl0ZXMubWFwKGIgPT4gYiAmIDB4RkYpKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOa3u+WKoEFTQ0lJ5a2X56ym5LiyXHJcbiAgICovXHJcbiAgcHVibGljIGFkZFN0cmluZyhuZXdTdHJpbmc6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgY29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xyXG4gICAgY29uc3QgYnl0ZXMgPSBlbmNvZGVyLmVuY29kZShuZXdTdHJpbmcpO1xyXG4gICAgdGhpcy5hZGRCeXRlcyhieXRlcyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmt7vliqDnu5PmnoTkvZMgLSBUeXBlU2NyaXB054mI5pys5L2/55SoQXJyYXlCdWZmZXJcclxuICAgKi9cclxuICBwdWJsaWMgYWRkU3RydWN0KHN0cnVjdERhdGE6IEFycmF5QnVmZmVyIHwgVWludDhBcnJheSk6IHZvaWQge1xyXG4gICAgaWYgKHN0cnVjdERhdGEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1xyXG4gICAgICB0aGlzLmFkZEJ5dGVzKG5ldyBVaW50OEFycmF5KHN0cnVjdERhdGEpKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuYWRkQnl0ZXMoc3RydWN0RGF0YSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmuIXnqbrnvJPlhrLljLpcclxuICAgKi9cclxuICBwdWJsaWMgY2xlYXIoKTogdm9pZCB7XHJcbiAgICB0aGlzLmRhdGFCdWZmZXIgPSBbXTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOW6j+WIl+WMluaVsOaNruWMhSAtIOWvueW6lEMj55qE5YWz6ZSu5Y2P6K6u5a6e546wXHJcbiAgICog5Y2P6K6u5qC85byPOiAweDU1IDB4QUEgW+i9rOS5ieWQjueahOaVsOaNrl0gMHhBQSAweDU1XHJcbiAgICog6L2s5LmJ6KeE5YiZOiAweEFBLzB4NTUvMHhGMCAtPiAweEYwICsgKOWOn+WAvCBeIDB4RjApXHJcbiAgICovXHJcbiAgcHVibGljIHNlcmlhbGl6ZSgpOiBVaW50OEFycmF5IHtcclxuICAgIGNvbnN0IGZpbmFsRGF0YTogbnVtYmVyW10gPSBbXTtcclxuXHJcbiAgICAvLyDmt7vliqDotbflp4vmoIforrBcclxuICAgIGZpbmFsRGF0YS5wdXNoKDB4NTUpO1xyXG4gICAgZmluYWxEYXRhLnB1c2goMHhBQSk7XHJcblxyXG4gICAgLy8g5a+55pWw5o2u6L+b6KGM6L2s5LmJ5aSE55CGXHJcbiAgICBmb3IgKGNvbnN0IGJ5dGUgb2YgdGhpcy5kYXRhQnVmZmVyKSB7XHJcbiAgICAgIGlmIChieXRlID09PSAweEFBIHx8IGJ5dGUgPT09IDB4NTUgfHwgYnl0ZSA9PT0gMHhGMCkge1xyXG4gICAgICAgIGZpbmFsRGF0YS5wdXNoKDB4RjApO1xyXG4gICAgICAgIGZpbmFsRGF0YS5wdXNoKGJ5dGUgXiAweEYwKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBmaW5hbERhdGEucHVzaChieXRlKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOa3u+WKoOe7k+adn+agh+iusFxyXG4gICAgZmluYWxEYXRhLnB1c2goMHhBQSk7XHJcbiAgICBmaW5hbERhdGEucHVzaCgweDU1KTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoZmluYWxEYXRhKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDph4fpm4bor7fmsYLnu5PmnoQgLSDln7rkuo5DIyBDYXB0dXJlUmVxdWVzdOeahOeyvuehruWGheWtmOW4g+WxgFxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBDYXB0dXJlUmVxdWVzdFN0cnVjdCB7XHJcbiAgdHJpZ2dlclR5cGU6IG51bWJlcjsgLy8gYnl0ZVxyXG4gIHRyaWdnZXI6IG51bWJlcjsgLy8gYnl0ZVxyXG4gIGludmVydGVkT3JDb3VudDogbnVtYmVyOyAvLyBieXRlXHJcbiAgdHJpZ2dlclZhbHVlOiBudW1iZXI7IC8vIHVzaG9ydCAoMTbkvY0pXHJcbiAgY2hhbm5lbHM6IFVpbnQ4QXJyYXk7IC8vIGJ5dGVbMjRdXHJcbiAgY2hhbm5lbENvdW50OiBudW1iZXI7IC8vIGJ5dGVcclxuICBmcmVxdWVuY3k6IG51bWJlcjsgLy8gdWludDMyICgzMuS9jSlcclxuICBwcmVTYW1wbGVzOiBudW1iZXI7IC8vIHVpbnQzMiAoMzLkvY0pXHJcbiAgcG9zdFNhbXBsZXM6IG51bWJlcjsgLy8gdWludDMyICgzMuS9jSlcclxuICBsb29wQ291bnQ6IG51bWJlcjsgLy8gYnl0ZVxyXG4gIG1lYXN1cmU6IG51bWJlcjsgLy8gYnl0ZSAoMC8xKVxyXG4gIGNhcHR1cmVNb2RlOiBudW1iZXI7IC8vIGJ5dGVcclxufVxyXG5cclxuLyoqXHJcbiAqIOe9kee7nOmFjee9rue7k+aehCAtIOWfuuS6jkMjIE5ldENvbmZpZ+eahOWbuuWumuWkp+Wwj+e8k+WGsuWMulxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBOZXRDb25maWdTdHJ1Y3Qge1xyXG4gIGFjY2Vzc1BvaW50TmFtZTogc3RyaW5nOyAvLyAzM+Wtl+iKguWbuuWumumVv+W6plxyXG4gIHBhc3N3b3JkOiBzdHJpbmc7IC8vIDY05a2X6IqC5Zu65a6a6ZW/5bqmXHJcbiAgaXBBZGRyZXNzOiBzdHJpbmc7IC8vIDE25a2X6IqC5Zu65a6a6ZW/5bqmXHJcbiAgcG9ydDogbnVtYmVyOyAvLyB1c2hvcnQgKDE25L2NKVxyXG59XHJcblxyXG4vKipcclxuICog6YeH6ZuG6K+35rGC5p6E5bu65ZmoIC0g55So5LqO5p6E5bu656ym5ZCIQyPnu5PmnoTkvZPluIPlsYDnmoTkuozov5vliLbmlbDmja5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBDYXB0dXJlUmVxdWVzdEJ1aWxkZXIge1xyXG4gIC8qKlxyXG4gICAqIOaehOW7uumHh+mbhuivt+axgueahOS6jOi/m+WItuaVsOaNrlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgYnVpbGRDYXB0dXJlUmVxdWVzdChzZXNzaW9uOiBDYXB0dXJlU2Vzc2lvbik6IFVpbnQ4QXJyYXkge1xyXG4gICAgY29uc3QgYnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKDY0KTsgLy8g6aKE5YiG6YWN6Laz5aSf55qE56m66Ze0XHJcbiAgICBjb25zdCB2aWV3ID0gbmV3IERhdGFWaWV3KGJ1ZmZlcik7XHJcbiAgICBsZXQgb2Zmc2V0ID0gMDtcclxuXHJcbiAgICAvLyDmjInnhadDI+e7k+aehOS9k+eahOeyvuehruW4g+WxgOWGmeWFpeaVsOaNrlxyXG4gICAgdmlldy5zZXRVaW50OChvZmZzZXQrKywgc2Vzc2lvbi50cmlnZ2VyVHlwZSk7IC8vIHRyaWdnZXJUeXBlOiBieXRlXHJcbiAgICB2aWV3LnNldFVpbnQ4KG9mZnNldCsrLCBzZXNzaW9uLnRyaWdnZXJDaGFubmVsKTsgLy8gdHJpZ2dlcjogYnl0ZVxyXG4gICAgdmlldy5zZXRVaW50OChvZmZzZXQrKywgc2Vzc2lvbi50cmlnZ2VySW52ZXJ0ZWQgPyAxIDogMCk7IC8vIGludmVydGVkT3JDb3VudDogYnl0ZVxyXG4gICAgdmlldy5zZXRVaW50MTYob2Zmc2V0LCBzZXNzaW9uLnRyaWdnZXJQYXR0ZXJuLCB0cnVlKTsgLy8gdHJpZ2dlclZhbHVlOiB1c2hvcnQsIGxpdHRsZSBlbmRpYW5cclxuICAgIG9mZnNldCArPSAyO1xyXG5cclxuICAgIC8vIGNoYW5uZWxzOiBieXRlWzI0XSAtIOmAmumBk+mFjee9ruaVsOe7hFxyXG4gICAgY29uc3QgY2hhbm5lbEFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoMjQpO1xyXG4gICAgc2Vzc2lvbi5jYXB0dXJlQ2hhbm5lbHMuZm9yRWFjaChjaCA9PiB7XHJcbiAgICAgIGlmIChjaC5jaGFubmVsTnVtYmVyID49IDAgJiYgY2guY2hhbm5lbE51bWJlciA8IDI0KSB7XHJcbiAgICAgICAgY2hhbm5lbEFycmF5W2NoLmNoYW5uZWxOdW1iZXJdID0gMTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDI0OyBpKyspIHtcclxuICAgICAgdmlldy5zZXRVaW50OChvZmZzZXQrKywgY2hhbm5lbEFycmF5W2ldKTtcclxuICAgIH1cclxuXHJcbiAgICB2aWV3LnNldFVpbnQ4KG9mZnNldCsrLCBzZXNzaW9uLmNhcHR1cmVDaGFubmVscy5sZW5ndGgpOyAvLyBjaGFubmVsQ291bnQ6IGJ5dGVcclxuICAgIHZpZXcuc2V0VWludDMyKG9mZnNldCwgc2Vzc2lvbi5mcmVxdWVuY3ksIHRydWUpOyAvLyBmcmVxdWVuY3k6IHVpbnQzMiwgbGl0dGxlIGVuZGlhblxyXG4gICAgb2Zmc2V0ICs9IDQ7XHJcbiAgICB2aWV3LnNldFVpbnQzMihvZmZzZXQsIHNlc3Npb24ucHJlVHJpZ2dlclNhbXBsZXMsIHRydWUpOyAvLyBwcmVTYW1wbGVzOiB1aW50MzIsIGxpdHRsZSBlbmRpYW5cclxuICAgIG9mZnNldCArPSA0O1xyXG4gICAgdmlldy5zZXRVaW50MzIob2Zmc2V0LCBzZXNzaW9uLnBvc3RUcmlnZ2VyU2FtcGxlcywgdHJ1ZSk7IC8vIHBvc3RTYW1wbGVzOiB1aW50MzIsIGxpdHRsZSBlbmRpYW5cclxuICAgIG9mZnNldCArPSA0O1xyXG4gICAgdmlldy5zZXRVaW50OChvZmZzZXQrKywgc2Vzc2lvbi5sb29wQ291bnQpOyAvLyBsb29wQ291bnQ6IGJ5dGVcclxuICAgIHZpZXcuc2V0VWludDgob2Zmc2V0KyssIHNlc3Npb24ubWVhc3VyZUJ1cnN0cyA/IDEgOiAwKTsgLy8gbWVhc3VyZTogYnl0ZVxyXG5cclxuICAgIC8vIOiuoeeul+mHh+mbhuaooeW8j1xyXG4gICAgY29uc3QgbWF4Q2hhbm5lbCA9IE1hdGgubWF4KC4uLnNlc3Npb24uY2FwdHVyZUNoYW5uZWxzLm1hcChjaCA9PiBjaC5jaGFubmVsTnVtYmVyKSk7XHJcbiAgICBjb25zdCBjYXB0dXJlTW9kZSA9IG1heENoYW5uZWwgPCA4ID8gQ2FwdHVyZU1vZGUuQ2hhbm5lbHNfOCA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgKG1heENoYW5uZWwgPCAxNiA/IENhcHR1cmVNb2RlLkNoYW5uZWxzXzE2IDogQ2FwdHVyZU1vZGUuQ2hhbm5lbHNfMjQpO1xyXG4gICAgdmlldy5zZXRVaW50OChvZmZzZXQrKywgY2FwdHVyZU1vZGUpOyAvLyBjYXB0dXJlTW9kZTogYnl0ZVxyXG5cclxuICAgIHJldHVybiBuZXcgVWludDhBcnJheShidWZmZXIsIDAsIG9mZnNldCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmnoTlu7rnvZHnu5zphY3nva7nmoTkuozov5vliLbmlbDmja5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGJ1aWxkTmV0Q29uZmlnKGNvbmZpZzogTmV0Q29uZmlnU3RydWN0KTogVWludDhBcnJheSB7XHJcbiAgICBjb25zdCBidWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoMTE1KTsgLy8gMzMgKyA2NCArIDE2ICsgMiA9IDExNeWtl+iKglxyXG4gICAgY29uc3QgdmlldyA9IG5ldyBEYXRhVmlldyhidWZmZXIpO1xyXG4gICAgbGV0IG9mZnNldCA9IDA7XHJcblxyXG4gICAgLy8gQWNjZXNzUG9pbnROYW1lOiAzM+Wtl+iKguWbuuWumumVv+W6plxyXG4gICAgY29uc3QgYXBOYW1lQnl0ZXMgPSBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoY29uZmlnLmFjY2Vzc1BvaW50TmFtZS5zbGljZSgwLCAzMikpO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAzMzsgaSsrKSB7XHJcbiAgICAgIHZpZXcuc2V0VWludDgob2Zmc2V0KyssIGkgPCBhcE5hbWVCeXRlcy5sZW5ndGggPyBhcE5hbWVCeXRlc1tpXSA6IDApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFBhc3N3b3JkOiA2NOWtl+iKguWbuuWumumVv+W6plxyXG4gICAgY29uc3QgcGFzc3dvcmRCeXRlcyA9IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShjb25maWcucGFzc3dvcmQuc2xpY2UoMCwgNjMpKTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNjQ7IGkrKykge1xyXG4gICAgICB2aWV3LnNldFVpbnQ4KG9mZnNldCsrLCBpIDwgcGFzc3dvcmRCeXRlcy5sZW5ndGggPyBwYXNzd29yZEJ5dGVzW2ldIDogMCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSVBBZGRyZXNzOiAxNuWtl+iKguWbuuWumumVv+W6plxyXG4gICAgY29uc3QgaXBCeXRlcyA9IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShjb25maWcuaXBBZGRyZXNzLnNsaWNlKDAsIDE1KSk7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDE2OyBpKyspIHtcclxuICAgICAgdmlldy5zZXRVaW50OChvZmZzZXQrKywgaSA8IGlwQnl0ZXMubGVuZ3RoID8gaXBCeXRlc1tpXSA6IDApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFBvcnQ6IHVzaG9ydCAoMTbkvY0pXHJcbiAgICB2aWV3LnNldFVpbnQxNihvZmZzZXQsIGNvbmZpZy5wb3J0LCB0cnVlKTsgLy8gbGl0dGxlIGVuZGlhblxyXG5cclxuICAgIHJldHVybiBuZXcgVWludDhBcnJheShidWZmZXIpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOaVsOaNrumHh+mbhuS6i+S7tuWPguaVsFxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIENhcHR1cmVFdmVudEFyZ3Mge1xyXG4gIHB1YmxpYyBzdWNjZXNzOiBib29sZWFuID0gZmFsc2U7XHJcbiAgcHVibGljIHNlc3Npb246IENhcHR1cmVTZXNzaW9uO1xyXG5cclxuICBjb25zdHJ1Y3RvcihzdWNjZXNzOiBib29sZWFuLCBzZXNzaW9uOiBDYXB0dXJlU2Vzc2lvbikge1xyXG4gICAgdGhpcy5zdWNjZXNzID0gc3VjY2VzcztcclxuICAgIHRoaXMuc2Vzc2lvbiA9IHNlc3Npb247XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICog6YeH6ZuG5a6M5oiQ5aSE55CG5Zmo57G75Z6LXHJcbiAqL1xyXG5leHBvcnQgdHlwZSBDYXB0dXJlQ29tcGxldGVkSGFuZGxlciA9IChhcmdzOiBDYXB0dXJlRXZlbnRBcmdzKSA9PiB2b2lkO1xyXG5cclxuLyoqXHJcbiAqIOagt+acrOWMuuWfn+WumuS5iSAtIOeUqOS6juaVsOaNruWvvOWHuuWSjOWIhuaekFxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBTYW1wbGVSZWdpb24ge1xyXG4gIC8qKiDotbflp4vmoLfmnKzntKLlvJUgKi9cclxuICBzdGFydFNhbXBsZTogbnVtYmVyO1xyXG4gIC8qKiDnu5PmnZ/moLfmnKzntKLlvJUgKi9cclxuICBlbmRTYW1wbGU6IG51bWJlcjtcclxuICAvKiog5Yy65Z+f5ZCN56ewICovXHJcbiAgbmFtZT86IHN0cmluZztcclxuICAvKiog5Yy65Z+f5o+P6L+wICovXHJcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XHJcbn1cclxuIl0sInZlcnNpb24iOjN9