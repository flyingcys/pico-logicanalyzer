{"file":"/home/share/samba/vscode-extension/pico-logicanalyzer/utest/setup.ts","mappings":"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","names":[],"sources":["/home/share/samba/vscode-extension/pico-logicanalyzer/utest/setup.ts"],"sourcesContent":["/**\n * Jest测试全局设置 - 修复版本\n * 修复了 Mock 对象的类型定义问题\n */\n\n// 首先设置Vue全局对象和编译器\nimport * as Vue from 'vue';\nimport * as VueCompilerDOM from '@vue/compiler-dom';\nimport * as VueServerRenderer from '@vue/server-renderer';\n\n// 设置Vue全局对象和编译器\n(global as any).Vue = Vue;\n(global as any).VueCompilerDOM = VueCompilerDOM;\n(global as any).VueServerRenderer = VueServerRenderer;\n\n// 设置完整的DOM环境\nglobal.window = global.window || ({\n  addEventListener: jest.fn(),\n  removeEventListener: jest.fn(),\n  dispatchEvent: jest.fn(),\n  innerWidth: 1024,\n  innerHeight: 768,\n  outerWidth: 1024,\n  outerHeight: 768,\n  scrollX: 0,\n  scrollY: 0,\n  pageXOffset: 0,\n  pageYOffset: 0,\n  localStorage: {\n    getItem: jest.fn((key) => {\n      const mockData: Record<string, string> = {\n        'theme': 'light',\n        'language': 'zh-CN',\n        'layout-preset': '{\"version\": 1}'\n      };\n      return mockData[key] || null;\n    }),\n    setItem: jest.fn(),\n    removeItem: jest.fn(),\n    clear: jest.fn(),\n    length: 0,\n    key: jest.fn().mockReturnValue(null)\n  },\n  sessionStorage: {\n    getItem: jest.fn(),\n    setItem: jest.fn(),\n    removeItem: jest.fn(),\n    clear: jest.fn(),\n    length: 0,\n    key: jest.fn().mockReturnValue(null)\n  },\n  performance: {\n    now: jest.fn(() => Date.now() + Math.random()),\n    mark: jest.fn(),\n    measure: jest.fn()\n  },\n  requestAnimationFrame: jest.fn((callback) => {\n    setTimeout(callback, 16);\n    return Math.random();\n  }),\n  cancelAnimationFrame: jest.fn(),\n  setTimeout: jest.fn((fn, ms) => {\n    const id = Math.random();\n    if (ms <= 100) {\n      try { fn(); } catch (e) { /* ignore */ }\n    }\n    return id;\n  }),\n  clearTimeout: jest.fn(),\n  setInterval: jest.fn(),\n  clearInterval: jest.fn()\n} as any);\n\nglobal.document = global.document || ({\n  documentElement: {\n    lang: 'en',\n    style: {}\n  },\n  addEventListener: jest.fn(),\n  removeEventListener: jest.fn(),\n  dispatchEvent: jest.fn(),\n  body: {\n    appendChild: jest.fn(),\n    removeChild: jest.fn(),\n    style: {},\n    clientWidth: 1024,\n    clientHeight: 768\n  },\n  createElement: jest.fn(() => ({\n    style: {},\n    addEventListener: jest.fn(),\n    removeEventListener: jest.fn(),\n    appendChild: jest.fn(),\n    removeChild: jest.fn(),\n    getAttribute: jest.fn(),\n    setAttribute: jest.fn(),\n    getContext: jest.fn(() => ({\n      clearRect: jest.fn(),\n      beginPath: jest.fn(),\n      moveTo: jest.fn(),\n      lineTo: jest.fn(),\n      stroke: jest.fn(),\n      fillText: jest.fn(),\n      save: jest.fn(),\n      restore: jest.fn(),\n      scale: jest.fn(),\n      translate: jest.fn(),\n      strokeStyle: '#000000',\n      fillStyle: '#000000',\n      lineWidth: 1,\n      font: '12px Arial'\n    })),\n    width: 1920,\n    height: 1080\n  }))\n} as any);\n\n// 修复 localStorage 全局对象\nglobal.localStorage = global.localStorage || {\n  getItem: jest.fn(),\n  setItem: jest.fn(),\n  removeItem: jest.fn(),\n  clear: jest.fn(),\n  length: 0,\n  key: jest.fn().mockReturnValue(null)\n} as Storage;\n\n// 修复 KeyboardEvent Mock\nglobal.KeyboardEvent = class MockKeyboardEvent extends Event {\n  static readonly DOM_KEY_LOCATION_STANDARD = 0;\n  static readonly DOM_KEY_LOCATION_LEFT = 1;\n  static readonly DOM_KEY_LOCATION_RIGHT = 2;\n  static readonly DOM_KEY_LOCATION_NUMPAD = 3;\n  \n  key: string;\n  keyCode: number;\n  which: number;\n  ctrlKey: boolean;\n  shiftKey: boolean;\n  altKey: boolean;\n  metaKey: boolean;\n  repeat: boolean;\n  code: string;\n  \n  constructor(type: string, eventInitDict?: KeyboardEventInit) {\n    super(type, eventInitDict);\n    this.key = eventInitDict?.key || '';\n    this.keyCode = eventInitDict?.keyCode || 0;\n    this.which = this.keyCode;\n    this.ctrlKey = eventInitDict?.ctrlKey || false;\n    this.shiftKey = eventInitDict?.shiftKey || false;\n    this.altKey = eventInitDict?.altKey || false;\n    this.metaKey = eventInitDict?.metaKey || false;\n    this.repeat = eventInitDict?.repeat || false;\n    this.code = eventInitDict?.code || '';\n  }\n} as any;\n\n// 修复 WheelEvent Mock\nglobal.WheelEvent = class MockWheelEvent extends Event {\n  static readonly DOM_DELTA_PIXEL = 0;\n  static readonly DOM_DELTA_LINE = 1;\n  static readonly DOM_DELTA_PAGE = 2;\n  \n  deltaX: number;\n  deltaY: number;\n  deltaZ: number;\n  deltaMode: number;\n  clientX: number;\n  clientY: number;\n  ctrlKey: boolean;\n  shiftKey: boolean;\n  altKey: boolean;\n  metaKey: boolean;\n  \n  constructor(type: string, eventInitDict?: WheelEventInit) {\n    super(type, eventInitDict);\n    this.deltaX = eventInitDict?.deltaX || 0;\n    this.deltaY = eventInitDict?.deltaY || 0;\n    this.deltaZ = eventInitDict?.deltaZ || 0;\n    this.deltaMode = eventInitDict?.deltaMode || 0;\n    this.clientX = eventInitDict?.clientX || 0;\n    this.clientY = eventInitDict?.clientY || 0;\n    this.ctrlKey = eventInitDict?.ctrlKey || false;\n    this.shiftKey = eventInitDict?.shiftKey || false;\n    this.altKey = eventInitDict?.altKey || false;\n    this.metaKey = eventInitDict?.metaKey || false;\n  }\n} as any;\n\n// 修复 MouseEvent Mock\nglobal.MouseEvent = class MockMouseEvent extends Event {\n  button: number;\n  buttons: number;\n  clientX: number;\n  clientY: number;\n  screenX: number;\n  screenY: number;\n  ctrlKey: boolean;\n  shiftKey: boolean;\n  altKey: boolean;\n  metaKey: boolean;\n  \n  constructor(type: string, options: any = {}) {\n    super(type, options);\n    this.button = options.button || 0;\n    this.buttons = options.buttons || 0;\n    this.clientX = options.clientX || 0;\n    this.clientY = options.clientY || 0;\n    this.screenX = options.screenX || 0;\n    this.screenY = options.screenY || 0;\n    this.ctrlKey = options.ctrlKey || false;\n    this.shiftKey = options.shiftKey || false;\n    this.altKey = options.altKey || false;\n    this.metaKey = options.metaKey || false;\n  }\n} as any;\n\n// 模拟Performance API\nif (!global.performance) {\n  global.performance = {\n    now: () => Date.now(),\n    mark: () => {},\n    measure: () => {},\n    getEntriesByName: () => [],\n    getEntriesByType: () => [],\n    clearMarks: () => {},\n    clearMeasures: () => {}\n  } as any;\n}\n\n// 确保requestAnimationFrame全局可用\nglobal.requestAnimationFrame = global.requestAnimationFrame || global.window.requestAnimationFrame;\nglobal.cancelAnimationFrame = global.cancelAnimationFrame || global.window.cancelAnimationFrame;\n\n// 模拟Path2D构造函数\nglobal.Path2D = global.Path2D || jest.fn().mockImplementation(() => ({\n  moveTo: jest.fn(),\n  lineTo: jest.fn(),\n  arc: jest.fn(),\n  quadraticCurveTo: jest.fn(),\n  bezierCurveTo: jest.fn(),\n  closePath: jest.fn(),\n  rect: jest.fn(),\n  ellipse: jest.fn(),\n  addPath: jest.fn()\n}));\n\n// 模拟Canvas API用于波形渲染测试\nclass MockCanvas {\n  width = 1920;\n  height = 1080;\n  \n  getContext(contextId: string) {\n    if (contextId === '2d') {\n      return {\n        clearRect: jest.fn(),\n        beginPath: jest.fn(),\n        moveTo: jest.fn(),\n        lineTo: jest.fn(),\n        stroke: jest.fn(),\n        fillText: jest.fn(),\n        save: jest.fn(),\n        restore: jest.fn(),\n        scale: jest.fn(),\n        translate: jest.fn(),\n        strokeStyle: '#000000',\n        fillStyle: '#000000',\n        lineWidth: 1,\n        font: '12px Arial'\n      };\n    }\n    return null;\n  }\n}\n\n// 模拟HTMLCanvasElement\nif (typeof window !== 'undefined') {\n  window.HTMLCanvasElement = MockCanvas as any;\n} else {\n  global.HTMLCanvasElement = MockCanvas as any;\n}\n\n// 模拟DOM APIs\nif (typeof document !== 'undefined') {\n  document.createElement = jest.fn((tagName: string) => {\n    if (tagName === 'canvas') {\n      return new MockCanvas() as any;\n    }\n    return {\n      style: {},\n      addEventListener: jest.fn(),\n      removeEventListener: jest.fn(),\n      appendChild: jest.fn(),\n      removeChild: jest.fn(),\n      getAttribute: jest.fn(),\n      setAttribute: jest.fn()\n    } as any;\n  });\n}\n\n// 设置测试超时\njest.setTimeout(10000);\n\n// 清理每个测试之间的状态\nafterEach(() => {\n  jest.clearAllMocks();\n  jest.clearAllTimers();\n});\n\n// 全局测试工具\nglobal.waitFor = (condition: () => boolean, timeout: number = 5000): Promise<void> => {\n  return new Promise((resolve, reject) => {\n    const startTime = Date.now();\n    const check = () => {\n      if (condition()) {\n        resolve();\n      } else if (Date.now() - startTime > timeout) {\n        reject(new Error(`Condition not met within ${timeout}ms`));\n      } else {\n        setTimeout(check, 10);\n      }\n    };\n    check();\n  });\n};\n\n// 异步延迟工具\nglobal.delay = (ms: number): Promise<void> => {\n  return new Promise(resolve => setTimeout(resolve, ms));\n};\n\nexport {};\n"],"version":3}